<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>OpenLayers Test</title>

    <!-- ExtJS -->
    <link rel="stylesheet" type="text/css" href="./scripts/ext-3.1.1/resources/css/ext-all.css" />
    <script type="text/javascript" src="./scripts/ext-3.1.1/adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="./scripts/ext-3.1.1/ext-all-debug.js"></script>

    <!-- OpenLayers -->
    <script type="text/javascript" src="http://www.openlayers.org/api/OpenLayers.js"></script>

    <!-- GeoExt -->
    <script type="text/javascript" src="./scripts/GeoExt-0.6.js"></script>
    <script type="text/javascript">
      OpenLayers.ProxyHost = "/cgi-bin/proxy.cgi?url=";
      Ext.onReady(function() {

        //Setup OpenLayers Map
        var map = new OpenLayers.Map();

        //Setup WFS Style
        var styleMap = new OpenLayers.StyleMap(
          OpenLayers.Util.applyDefaults({
            fillColor: "green",
            fillOpacity: 1,
            strokeColor: "black"
            },
            OpenLayers.Feature.Vector.style["default"]
          ));

        //Setup OpenLayers Layer
        var base = new OpenLayers.Layer.WMS(
          "MetaCarta WMS",
          "http://labs.metacarta.com/wms-c/Basic.py",
          { layers: "basic" }
          );

        var geoserverWMS = new OpenLayers.Layer.WMS(
          "Geoserver WMS: Itasca Lakes",
          "http://tub.ath.cx:8080/geoserver/wms",
          {layers: "prco303:itasca", transparent: "true"},
          {isBaseLayer: false, projection: "EPSG:26915"}
          );

        var geoserver = new OpenLayers.Layer.Vector( "GeoServer WFS: Itasca Lakes", {
          strategies: [new OpenLayers.Strategy.BBOX()],
          styleMap: styleMap,
          projection: new OpenLayers.Projection("EPSG:26915"),
          protocol: new OpenLayers.Protocol.WFS({
              version: "1.1.0",
              url: "http://tub.ath.cx:8080/geoserver/wfs",
              featureType: "prco303:itasca",
              //featureNS: "http://tub.ath.cx/geoserver/wfs",
              geometryName: "the_geom",
              srs: "EPSG:26915"
              })
          });

        map.addLayer( base );

        var mapPanel = new GeoExt.MapPanel({
          title: "Map",
          region: "center",
          map: map,
          extent: new OpenLayers.Bounds(-94.428, 47.018, -93.06, 47.889),
          layers: [ geoserver, geoserverWMS ]
        });

        new Ext.Viewport({
            title: "Collaborative Geospatial Environment",
            renderTo: "map",
            layout:"fit",
          items : [{
		  layout : "border",
		  items : [ mapPanel,    {
		      region : "south",
		      title : "Feature Information",
		      split : false,
		      collapsible : true,
		      height : 200
		  },    {
		      region : "east",
		      width : 240,
		      items : [        {
			  layout : "accordion",
			  layoutConfig : {
		    activeOnTop : false,
		    animate : true,
		    autoWidth : true,
		    collapseFirst : true,
		    fill : true,
		    hideCollapseTool : false,
		    titleCollapse : true
		},
			  items : [            {
			      title : "Information",
			      html : "<p>This is the interface for the Collaborative Geospatial Environment.</p>",
			      autoHeight : true
			  },            {
			      xtype : "form",
			      items : [                {
				  xtype : "textfield",
				  name : "textvalue",
				  fieldLabel : "Username"
			      },                {
				  xtype : "textfield",
				  name : "textvalue",
				  fieldLabel : "Password"
			      },                {
				  xtype : "button",
				  text : "Ok"
			      }],
			      autoHeight : true,
			      title : "Login"
			  },            {
			      xtype : "panel",
			      autoHeight : true,
			      items : [                {
				  xtype : "treepanel",
				  animate : true,
				  autoScroll : true,
				  containerScroll : true,
				  root : new GeoExt.tree.LayerContainer({
          text: "All Layers",
          layerStore: mapPanel.layers,
          leaf: false,
          expanded: true
          }),
				  dropConfig : {
		    appendOnly : true
		}
			      }],
			      title : "Layers"
			  },            {
			      xtype : "panel",
			      autoHeight : true,
			      title : "Editing"
			  }]
		      }]
		  }],
		  json : {
		  size :   {
		    width : 897,
		    height : 603
		}
		}
		}]
        }).show();
      });
    </script>
  </head>
  <body>
    <div id="map"></div>
  </body>
</html>
